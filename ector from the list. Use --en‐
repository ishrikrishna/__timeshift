INSTALL-MBR(8)           Linux Administrator's Manual           INSTALL-MBR(8)

NNAAMMEE
       install-mbr - install a Master Boot Record manager

SSYYNNOOPPSSIISS
       iinnssttaallll--mmbbrr <_t_a_r_g_e_t>  [----ffoorrccee]  [----iinnssttaallll <_p_a_t_h>]  [----kkeeeepp]  [----lliisstt]
        [----nnoo--aacctt]  [----ooffffsseett <_o_f_f_s_e_t>]  [----yy22kkbbuugg[==uuttcc|==llooccaall]]    [----ppaarraammee‐‐
       tteerrss  <_p_a_t_h>]    [----rreesseett]  [----ttaabbllee <_p_a_t_h>]  [----vveerrbboossee]  [----vveerrssiioonn]
       [----hheellpp]  [----ddrriivvee <_d_r_i_v_e>]  [----eennaabbllee <_o_p_t_i_o_n_s>]  [----iinntteerrrruupptt <_k_e_y_s>]
        [----ppaarrttiittiioonn <_p_a_r_t_i_t_i_o_n>]  [----ttiimmeeoouutt <_t_i_m_e_o_u_t>]

DDEESSCCRRIIPPTTIIOONN
       iinnssttaallll--mmbbrr  installs  and configures a Master Boot Record manager on a
       device.  The behaviour of the boot manager is determined by the options
       given  on the command line.  <_t_a_r_g_e_t> is the path specifying the device
       (or file) that the boot manager should be installed onto.

MMBBRR BBEEHHAAVVIIOOUURR
       When the MBR is first loaded it waits for a configurable length of time
       (1  second  by  default), monitoring the keyboard for key presses.  The
       types of key which cause the MBR to be interrupted  can  be  configured
       through the -i option to install-mbr.

       If  the  MBR  is interrupted, it will display its prompt.  Otherwise it
       will load the first sector of the default partition and execute it.  If
       a  disk  error occurs or the boot signature is missing, the prompt will
       be displayed.

   TThhee bboooott pprroommpptt
       The boot prompt looks something like this:

              14FA:

       This is the list of valid keys which  may  be  pressed  followed  by  a
       colon.   Numeric keys indicate primary partitions on the disk beginning
       with partition 1 and 'F' indicates the floppy  disk.   Extended  parti‐
       tions  cannot be booted.  The 'A' means that 'advanced' mode may be en‐
       tered, in which case any partition may be booted.  The only other valid
       key  which  may  be pressed is RETURN, which continues booting with the
       default partition.

       The prompt for advanced mode looks like this and works just the same as
       the normal prompt.

              1234F:

       The  list  of valid partitions and the default partition can be config‐
       ured through the -e and -p options to install-mbr.

OOPPTTIIOONNSS
   IInnssttaallllaattiioonn ooppttiioonnss
       These options change the way the installation program operates.

       ----ffoorrccee, --ff
              This option currently overrides a check to make sure the  speci‐
              fied target is valid.

       ----iinnssttaallll <_p_a_t_h>, --II <_p_a_t_h>
              This option may be used to install code other than that which is
              built in to iinnssttaallll--mmbbrr.  It is mainly useful for  testing,  but
              may be used to install older versions of the MBR.

       ----kkeeeepp, --kk
              This  option  instructs  the  installer to modify the parameters
              stored in the MBR without updating the code.

       ----lliisstt, --ll
              This option may be used to view the parameters  being  installed
              in  the MBR.  It implies the ----nnoo--aacctt and ----kkeeeepp flags unless an
              option other than ----ooffffsseett, ----vveerrbboossee or ----lliisstt is given.   This
              allows the contents of the MBR to be examined.

       ----nnoo--aacctt, --nn
              This  option  ensures  that the target is not modified, as it is
              opened in read-only mode.

       ----ooffffsseett <_o_f_f_s_e_t>, --oo <_o_f_f_s_e_t>
              This option may be used to install the MBR somewhere other  than
              the  start  of  the  target.  The offset specifies the number of
              bytes from the start of the target at which the  MBR  should  be
              installed.  For example, an offset of 128 may be used for DOSEMU
              disk images.

       ----yy22kkbbuugg[==uuttcc|==llooccaall|==ooffff], --yy[uu|ll|--]
              This option specifies the status of the Y2K bug  fix  parameter.
              When  set,  an alternative MBR is installed that fixes a Y2K bug
              in some BIOSes that causes them to always boot  up  the  machine
              with  the  year ranging from 94 to 99.  This MBR stores the cur‐
              rent month and year and sets the year based  on  this  when  the
              computer  is  booted.   It also increases the year automatically
              when the current month is lower than the month of the last boot.
              The  initial  year and month are set based on the current system
              time converted to UTC or the local time as specified by the  ar‐
              gument.   If  the argument is not specified, the default is read
              from /etc/default/rcS.  Due to space limitations,  the  alterna‐
              tive  version  of  the  MBR  does not display the word MBR as it
              boots.  If the argument is ==ooffff or -- the Y2K  bug  fix  is  dis‐
              abled.   WWAARRNNIINNGG::  The Y2K bug fix will work fine until you want
              to set the date backwards.  When you do want  to  do  this,  you
              will need to reinstall the MBR.  You cannot just set the date in
              the BIOS (since the whole point of this option is that the  year
              provided by the BIOS is ignored).

       ----ppaarraammeetteerrss <_p_a_t_h>, --PP <_p_a_t_h>
              This  option may be used to copy parameters from somewhere other
              than the target.  The path specifies a location where a  version
              of  this  MBR  has  been  installed and parameters are read from
              there.  It could be used to copy parameters from one disk to an‐
              other disk.

       ----rreesseett, --rr
              This  option  is  used to reset the boot parameters to the state
              found in the code being installed (or code which  would  be  in‐
              stalled if ----kkeeeepp were not specified).

       ----ttaabbllee <_p_a_t_h>, --TT <_p_a_t_h>
              The master boot record currently uses the partition table in the
              sector which contains it to locate boot sectors (This  behaviour
              may  change  with  future versions of the MBR, in which case the
              option may be withdrawn).  The ----ttaabbllee option is used to copy  a
              partition  table  from  another location to the target location.
              Any data stored on the target disk may be lost (as the partition
              table  is  overwritten),  so this option should be used with ex‐
              treme caution.  As the partition table is  copied,  any  changes
              made  to the original partition table will not be noticed.  This
              option is only provided to make installation to floppy easy.

       ----vveerrbboossee, --vv
              When invoked with this option, iinnssttaallll--mmbbrr will display some in‐
              formation about what it is doing.

       ----vveerrssiioonn, --VV
              This  option will cause iinnssttaallll--mmbbrr to display it's version num‐
              ber and exit.

       ----hheellpp, --hh
              This option will cause iinnssttaallll--mmbbrr to display a help message and
              exit.

   PPaarraammeetteerr ooppttiioonnss
       These  options  change  the  parameters  stored  within the Master Boot
       Record.

       ----ddrriivvee <_d_r_i_v_e>, --dd <_d_r_i_v_e>
              This option instructs the MBR to boot a  drive  other  than  the
              first  hard disk.  It may be specified in decimal or hexadecimal
              if prefixed with 0x.  Hard disks are numbered starting from  128
              (0x80).

       ----eennaabbllee <_o_p_t_i_o_n>, --ee <_o_p_t_i_o_n>
              This  option  sets  the list of boot sectors which may be loaded
              (or advanced mode).  A boot sector may be loaded from one of the
              first  4 partitions of the disk, or from the first floppy drive.
              Use ----eennaabbllee ++<_s_p_e_c> to add a boot sector to the list  or  ----eenn‐‐
              aabbllee  --<_s_p_e_c>  to remove a boot sector from the list.  Use ----eenn‐‐
              aabbllee ==<_s_p_e_c> to set the list to <_s_p_e_c>.  <_s_p_e_c> may contain:

              11, 22, 33, 44
                          The specified partition number.

              FF           The first floppy disk.

              AA           Advanced mode (not a boot sector).

       ----iinntteerrrruupptt <_m_o_d_e>, --ii <_m_o_d_e>
              This option sets the list of events which will cause the MBR  to
              display  it's  prompt.   Use  -i +<event> to add an event to the
              list or -i -<event> to remove an event from the list.  Values of
              <event> are:

              ss      A shift or control key is pressed.

              kk      A non shift-like key is pressed

              aa      The prompt is always displayed.

              nn      Never display the prompt (unless an error occurs).

       --pp <_p_a_r_t_n>, ----ppaarrttiittiioonn <_p_a_r_t_n>
              This specifies the default boot sector to load.  Valid values of
              <_p_a_r_t_n> are:

              11, 22, 33, 44
                     The specified partition number.

              FF      The first floppy disk.

              DD      The partition marked with the bootable flag in the parti‐
                     tion table.

       --tt <_t_i_m_e_o_u_t>, ----ttiimmeeoouutt <_t_i_m_e_o_u_t>
              This  option  changes  the  time  which the MBR waits for before
              booting the default partition to the  value  specified  in  1/18
              seconds  (approx).  The maximum timeout that can be specified is
              65534 which is about an hour.

EEXXAAMMPPLLEESS
       iinnssttaallll--mmbbrr //ddeevv//ffdd00 --TT //ddeevv//hhddaa

       Install the default MBR image on //ddeevv//ffdd00, taking the  partition  table
       from //ddeevv//hhddaa.

       iinnssttaallll--mmbbrr --kkrr //ddeevv//hhddaa

       Reset the parameters on //ddeevv//hhddaa without installing any new code.

       iinnssttaallll--mmbbrr --II mmyy--mmbbrr --TT //ddeevv//hhddaa --PP mmyy--ppaarraammeetteerrss //ddeevv//ffdd00

       Install  to  //ddeevv//ffdd00,  taking  code  from mmyy--mmbbrr, partition table from
       //ddeevv//hhddaa and parameters from my-parameters.

       iinnssttaallll--mmbbrr --ll --oo 112288 hhddiimmaaggee

       List the parameters stored at offset 128 in hhddiimmaaggee (may  be  a  DOSEMU
       image).

       iinnssttaallll--mmbbrr --dd 00xx8811 --TT //ddeevv//hhddbb //ddeevv//ffdd00

       Install  on  //ddeevv//ffdd00 to boot from BIOS drive 129 (0x81) with partition
       table copied from //ddeevv//hhddbb.

       iinnssttaallll--mmbbrr --ee 1133 //ddeevv//hhddaa

       iinnssttaallll--mmbbrr --ee 22 --ee ==1133 //ddeevv//hhddaa

       iinnssttaallll--mmbbrr --ee11 --ee33 //ddeevv//hhddaa

       Enable booting from partitions 1 and 3 on  //ddeevv//hhddaa.   Other  locations
       are disabled.

       iinnssttaallll--mmbbrr --ee ++ff--aa --ii sskk //ddeevv//hhddaa

       Enabled booting from the floppy drive, and disable advanced mode.  Dis‐
       play the prompt if any shift, control or non shift-like key is pressed.
       Other settings are untouched.

DDIIAAGGNNOOSSTTIICCSS
       CCaannnnoott hhaannddllee MMBBRR vveerrssiioonn nn ((bbaacckkwwaarrddss ccoommppaattiibbllee ttoo nn))

              This  error  means  that  the  version of MBR which is being in‐
              stalled is not known about by this installer.  Such files cannot
              have  their parameters read or written.  If such a newer version
              is installed, it can be downgraded by specifying the ----rreesseett op‐
              tion (without specifying ----kkeeeepp).

SSEEEE AALLSSOO
       ggrruubb(8), lliilloo(8)

BBUUGGSS
       The operation of ----lliisstt may be confusing.

AAUUTTHHOORR
       iinnssttaallll--mmbbrr   was  written  for  the  Debian  project  by  Neil  Turton
       <neilt+mbr@chiark.greenend.org.uk>.

Linux                            16 April 2006                  INSTALL-MBR(8)
